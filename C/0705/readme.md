### 字符串

字符串字面量（string literal)是用一对双引号括起来的字符序列。

#### 存储字符串字面量
从本质而言，C语言把字符串字面量作为字符数组来处理。当C语言编译器在程序中遇到长度为n的字符串字面量时，它会为字符串字面量分配长度为n+1的内存空间。这块内存空间将用来存储字符串字面量中的字符，以及一个用来标志字符串末尾的额外字符（空字符）。空字符是一个所有位都为0的字节。因此用转义序列\0来表示。

既然字符串字面量是作为数组来存储的，那么编译器会把它看作是char * 类型的指针。
例如，printf函数和scanf函数都接收char * 类型的值作为它们的第一个参数。

```c
printf("abc");
```
当调用printf函数时，会传递"abc"的地址（即指向存储字母a的内存单元的指针）。

#### 字符串字面量的操作
```c
char *p;
p = "abc";
```
这个赋值操作不是复制"abc"中的字符，而是使p指向字符串的第一个字符。

C语言允许对指针取下标，因此可以对字符串字面量取下标：
```c
char ch;

ch = "abc"[1];
```
ch的新值将是字母b。

一些编程语言为声明字符串变量提供了专门的string类型。C语言采取了不同的方式：只要保证字符串是以空字符结尾的，任何一维的字符数组都可以用来存储字符串。这种方法很简单，但是使用起来有很大难度。有时候很难辨别是否把字符数组作为字符串来使用。

如果编写自己的字符串处理函数，请千万注意要正确地处理空字符串，而且，要确定字符串长度没有比逐个字符地搜索空字符更快捷的方法了。

假设需要用一个变量来存储最多80个字符的字符串。由于字符串在末尾处需要有空字符，我们把变量声明为包含81个字符的数组。
```c
#define STR_LEN 80
...
char str[STR_LEN+1];
```
这里把STR_LEN定义为80而不是81，强调的是str可以存储最多有80个字符的字符串；然后才在str的声明中对STR_LEN加1。这是C程序员常用的方式。

当声明用于存放字符串的字符数组时，要始终保证数组的长度比字符串的长度多一个字符。这是因为C语言规定每个字符串都要以空字符结尾。如果没有给空字符预留位置，可能会导致程序运行时出现不可预知的结果。因为C函数库中的函数假设字符串都是以空字符结束的。

声明长度为STR_LEN+1的字符数组并不意味着它总是用于存放长度为STR_LEN的字符串。字符串的长度取决于空字符的位置，而不是取决于用于存放字符串的字符数组的长度。有STR_LEN+1个字符的数组可以存放多种长度的字符串，范围是从空字符串到长度为STR_LEN的字符串。

#### 初始化字符串变量
```c
char date1[8] = "June 14";
```
编译器将把字符串"June 14"中的字符复制到数组date1中，然后追加一个空字符串从而使date1可以作为字符串使用。

"June 14"看起来是字符串字面量，但其实不然。C编辑器会把它看成是数组初始化的缩写形式。实际上，我们可以写成：

```c
char date1[8] = {'J','u','n','e',' ','1','4','\0'};
```
如果初始化式太短以致于不能填满字符串变量，这种情况，编译器会添加空字符。

如果初始化式比字符串变量长，这是非法的。然而，C语言允许初始化时（不包含空字符）与变量有完全相同的长度：
```c
char date1[7] = {'J','u','n','e',' ','1','4','\0'};
```
如果计划对用来放置字符串的字符数组进行初始化，一定要确保数组的长度要长于初始化的长度，否则，编译器将忽略空字符串，这将使得数组`无法作为字符串使用`。

字符串变量的声明中可以省略它的长度，这种情况下，编译器会自动计算长度：
```c
char date4[] = "June 14";
```
编译器为date4分配8个字符的空间，这足够存储"June 14"中的字符和一个空字符。`不指定date4的长度并不意味着以后可以改变数组的长度，一旦编译了程序，date4的长度就固定是8了`。如果初始化式很长，那么省略字符串变量的长度特别有效，因为手工计算容易出错。